<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Sugg">
	<!-- <select id="getSuggList" resultType="java.util.Map" parameterType="java.lang.String">
		SELECT SUGG_ID
			,(SELECT NAME FROM CRD_MEM WHERE MEM_ID =SER.CUSTOMER_ID) as NAME 
			,TO_CHAR(SUGG_DATE,'YYYY-MM-DD HH24:MI:SS') as SUGG_DATE, CHOOSE_YN
			, SUG.PER_BUD,TO_CHAR(SERV_DATE ,'YYYY-MM-DD HH24:MI') as SERV_DATE 
		FROM CRD_SERV_APP SER, CRD_SERV_SUGG  SUG 
		WHERE SER.SERV_ID = SUG.SERV_ID 
		AND SUG.MEM_ID= #{suggId}
	</select> -->
	<select id="getSuggListCount" resultType="int" parameterType="java.lang.String">
		SELECT 
			COUNT(*)
		FROM CRD_SERV_APP SER, CRD_SERV_SUGG  SUG 
		WHERE SER.SERV_ID = SUG.SERV_ID 
		AND SUG.MEM_ID= #{memId}
	</select>
	<select id="getSuggList" resultType="java.util.Map" parameterType="java.util.Map">
		SELECT 
			SUGG_ID, NAME,SUGG_DATE, CHOOSE_YN, PER_BUD, SERV_DATE 
		FROM (
			SELECT 
				A.*,ROWNUM AS NUM 
			FROM (
				SELECT SUGG_ID
					,(SELECT NAME FROM CRD_MEM WHERE MEM_ID =SER.CUSTOMER_ID) AS NAME 
					,TO_CHAR(SUGG_DATE,'YYYY-MM-DD HH24:MI:SS') AS SUGG_DATE, CHOOSE_YN
					, SUG.PER_BUD,TO_CHAR(SERV_DATE ,'YYYY-MM-DD HH24:MI') AS SERV_DATE 
				FROM CRD_SERV_APP SER, CRD_SERV_SUGG  SUG 
				WHERE SER.SERV_ID = SUG.SERV_ID 
				AND SUG.MEM_ID= #{memId}
			    ORDER BY SUGG_DATE DESC
			) A
		)WHERE NUM  BETWEEN #{startNum} AND #{endNum}

	</select>
	
	<select id="getSuggInfo" parameterType="java.lang.String" resultType="java.util.Map">
		SELECT 
			APP.SERV_ID as SERV_ID
			,(SELECT NAME FROM CRD_MEM WHERE MEM_ID =APP.CUSTOMER_ID) AS NAME 
			, TO_CHAR(SUGG_DATE,'YYYY-MM-DD HH24:MI:SS') AS SUGG_DATE, CHOOSE_YN
			, SUGG.PER_BUD,TO_CHAR(SERV_DATE ,'YYYY-MM-DD HH24:MI') AS SERV_DATE 
			, PARTICIPANT
			, ZIPCODE
			, ADDRESS
			, ADDRESS_DETAIL
			, AGE_MIN
			, AGE_MAX
			, PER_MEN
			, SERV_TYPE_CODE
			, EVENT_TYPE_CODE
			, DESSERT_YN
			, INTERIOR_YN
			, COOKING_YN
			, DISCHARGE_YN
			, PARKING_YN
			, TABLEWARE_YN
			, ELEVATOR_YN
			, COORDINATOR_YN
			, OTHER_ORDER_YN
			, REQUESTED_TERM
		FROM CRD_SERV_SUGG SUGG, CRD_SERV_APP APP 
		WHERE SUGG.SERV_ID = APP.SERV_ID
		AND SUGG.SUGG_ID = 'G190712-0002'
	</select>
	<select id="getSuggMenuInfo" parameterType="java.lang.String" resultType="java.util.Map">
		SELECT 
			MENU_SEQ
			, NAME
			, WEIGHT
			, EXPLANATION
			, FILE_ID
		FROM CRD_SERV_SUGG_MENU 
		WHERE SUGG_ID = #{suggId}
	</select>
</mapper>